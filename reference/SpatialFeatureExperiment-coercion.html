<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SpatialFeatureExperiment coercion methods — SpatialFeatureExperiment-coercion • SpatialFeatureExperiment</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SpatialFeatureExperiment coercion methods — SpatialFeatureExperiment-coercion"><meta name="description" content='The SpatialFeatureExperiment class inherits from
SpatialExperiment, which in turn inherits from
SingleCellExperiment. A SpatialExperiment object with
geometries in colGeometries in the int_colData,
rowGeometries in the int_elementMetadata, or
annotGeometries in the int_metadata can be directly converted
to SpatialFeatureExperiment with as(spe,
"SpatialFeatureExperiment"). A SpatialExperiment object without the
geometries can also be converted; the coordinates in the spatialCoords
field will be used to make POINT geometries named "centroids" to add to
colGeometries. The geometries can also be supplied separately when
using toSpatialFeatureExperiment. Images are converted to SpatRaster.'><meta property="og:description" content='The SpatialFeatureExperiment class inherits from
SpatialExperiment, which in turn inherits from
SingleCellExperiment. A SpatialExperiment object with
geometries in colGeometries in the int_colData,
rowGeometries in the int_elementMetadata, or
annotGeometries in the int_metadata can be directly converted
to SpatialFeatureExperiment with as(spe,
"SpatialFeatureExperiment"). A SpatialExperiment object without the
geometries can also be converted; the coordinates in the spatialCoords
field will be used to make POINT geometries named "centroids" to add to
colGeometries. The geometries can also be supplied separately when
using toSpatialFeatureExperiment. Images are converted to SpatRaster.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SpatialFeatureExperiment</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/seurat_sfe_coerce.html">Seurat_to_SFE</a></li>
    <li><a class="dropdown-item" href="../articles/SFE.html">Introduction to the SpatialFeatureExperiment class</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pachterlab/SpatialFeatureExperiment/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SpatialFeatureExperiment coercion methods</h1>
      <small class="dont-index">Source: <a href="https://github.com/pachterlab/SpatialFeatureExperiment/blob/documentation/R/coerce.R" class="external-link"><code>R/coerce.R</code></a></small>
      <div class="d-none name"><code>SpatialFeatureExperiment-coercion.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>SpatialFeatureExperiment</code> class inherits from
<code>SpatialExperiment</code>, which in turn inherits from
<code>SingleCellExperiment</code>. A <code>SpatialExperiment</code> object with
geometries in <code>colGeometries</code> in the <code>int_colData</code>,
<code>rowGeometries</code> in the <code>int_elementMetadata</code>, or
<code>annotGeometries</code> in the <code>int_metadata</code> can be directly converted
to <code>SpatialFeatureExperiment</code> with <code>as(spe,
"SpatialFeatureExperiment")</code>. A <code>SpatialExperiment</code> object without the
geometries can also be converted; the coordinates in the <code>spatialCoords</code>
field will be used to make POINT geometries named "centroids" to add to
<code>colGeometries</code>. The geometries can also be supplied separately when
using <code>toSpatialFeatureExperiment</code>. Images are converted to <code>SpatRaster</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'SpatialExperiment'</span></span>
<span><span class="fu">toSpatialFeatureExperiment</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  colGeometries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rowGeometries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatialCoordsNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>  annotGeometryType <span class="op">=</span> <span class="st">"POLYGON"</span>,</span>
<span>  spatialGraphs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spotDiameter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  unit <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SingleCellExperiment'</span></span>
<span><span class="fu">toSpatialFeatureExperiment</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="st">"sample01"</span>,</span>
<span>  spatialCoordsNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>  spatialCoords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGeometries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rowGeometries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryType <span class="op">=</span> <span class="st">"POLYGON"</span>,</span>
<span>  spatialGraphs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spotDiameter <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  scaleFactors <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  imageSources <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  image_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loadImage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  imgData <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unit <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Seurat'</span></span>
<span><span class="fu">toSpatialFeatureExperiment</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  add_molecules <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  flip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geometry"</span>, <span class="st">"image"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  image_scalefactors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lowres"</span>, <span class="st">"hires"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">SerialParam</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>SpatialExperiment</code> or <code>Seurat</code> object to be coerced to a
<code>SpatialFeatureExperiment</code> object.</p></dd>


<dt id="arg-colgeometries">colGeometries<a class="anchor" aria-label="anchor" href="#arg-colgeometries"></a></dt>
<dd><p>Geometry of the entities that correspond to the columns
of the gene count matrix, such as cells and Visium spots. It must be a
named list of one of the following:</p><dl><dt>An <code>sf</code> data
frame</dt>
<dd><p>The geometry column specifies the geometry of the entities.</p></dd>

<dt>An ordinary data frame specifying centroids</dt>
<dd><p>Column names for the
coordinates are specified in the <code>spatialCoordsNames</code> argument. For
Visium and ST, in addition to the centroid coordinate data frame, the spot
diameter in the same unit as the coordinates can be specified in the
<code>spotDiamter</code> argument.</p></dd>
 <dt>An ordinary data frame specifying
polygons</dt>
<dd><p>Also use <code>spatialCoordsNames</code>. There should an additional
column "ID" to specify which vertices belong to which polygon. The
coordinates should not be in list columns. Rather, the data frame should
look like it is passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">ggplot2::geom_polygon</a></code>. If there are holes,
then there must also be a column "subID" that differentiates between the
outer polygon and the holes.</p></dd>

</dl><p>In all cases, the data frame should specify
the same number of geometries as the number of columns in the gene count
matrix. If the column "barcode" is present, then it will be matched to
column names of the gene count matrix. Otherwise, the geometries are
assumed to be in the same order as columns in the gene count matrix. If the
geometries are specified in an ordinary data frame, then it will be
converted into <code>sf</code> internally. Named list of data frames because each
entity can have multiple geometries, such as whole cell and nuclei
segmentations. The geometries are assumed to be POINTs for centroids and
POLYGONs for segmentations. If polygons are specified in an ordinary data
frame, then anything with fewer than 3 vertices will be removed. For
anything other than POINTs, attributes of the geometry will be ignored.</p></dd>


<dt id="arg-rowgeometries">rowGeometries<a class="anchor" aria-label="anchor" href="#arg-rowgeometries"></a></dt>
<dd><p>Geometry associated with genes or features, which
correspond to rows of the gene count matrix.</p></dd>


<dt id="arg-annotgeometries">annotGeometries<a class="anchor" aria-label="anchor" href="#arg-annotgeometries"></a></dt>
<dd><p>Geometry of entities that do not correspond to columns
or rows of the gene count matrix, such as tissue boundary and pathologist
annotations of histological regions, and nuclei segmentation in a Visium
dataset. Also a named list as in <code>colGeometries</code>. The ordinary data
frame may specify POINTs, POLYGONs, or LINESTRINGs, or their MULTI
versions. Each data frame can only specify one type of geometry. For MULTI
versions, there must be a column "group" to identify each MULTI geometry.</p></dd>


<dt id="arg-spatialcoordsnames">spatialCoordsNames<a class="anchor" aria-label="anchor" href="#arg-spatialcoordsnames"></a></dt>
<dd><p>A <code>character</code> vector of column names if
<code>*Geometries</code> arguments have ordinary data frames, to identify the
columns in the ordinary data frames that specify the spatial coordinates.
If <code>colGeometries</code> is not specified, then this argument will behave as
in <code><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment.html" class="external-link">SpatialExperiment</a></code>, but <code>colGeometries</code> will be given
precedence if provided.</p></dd>


<dt id="arg-annotgeometrytype">annotGeometryType<a class="anchor" aria-label="anchor" href="#arg-annotgeometrytype"></a></dt>
<dd><p>Character vector specifying geometry type of each
element of the list if <code>annotGeometry</code> is specified. Each element of
the vector must be one of POINT, LINESTRING, POLYGON, MULTIPOINT,
MULTILINESTRING, and MULTIPOLYGON. Must be either length 1 (same for all
elements of the list) or the same length as the list. Ignored if the
corresponding element is an <code>sf</code> object.</p></dd>


<dt id="arg-spatialgraphs">spatialGraphs<a class="anchor" aria-label="anchor" href="#arg-spatialgraphs"></a></dt>
<dd><p>A named list of <code>listw</code> objects (see <code>spdep</code>)
for spatial neighborhood graphs.</p></dd>


<dt id="arg-spotdiameter">spotDiameter<a class="anchor" aria-label="anchor" href="#arg-spotdiameter"></a></dt>
<dd><p>Spot diameter for technologies with arrays of spots of
fixed diameter per slide, such as Visium, ST, DBiT-seq, and slide-seq. The
diameter must be in the same unit as the coordinates in the *Geometry
arguments. Ignored for geometries that are not POINT or MULTIPOINT.</p></dd>


<dt id="arg-unit">unit<a class="anchor" aria-label="anchor" href="#arg-unit"></a></dt>
<dd><p># Default unit is <code>"micron"</code>. However for Visium one can choose
between <code>"micron"</code> or <code>"full_res_image_pixel"</code>.</p></dd>


<dt id="arg-sample-id">sample_id<a class="anchor" aria-label="anchor" href="#arg-sample-id"></a></dt>
<dd><p>A <code>character</code> sample identifier, which matches the
<code>sample_id</code> in <code><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">imgData</a></code>. The <code>sample_id</code> will also
be stored in a new column in <code><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-colData.html" class="external-link">colData</a></code>, if not already present.
Default = <code>sample01</code>.</p></dd>


<dt id="arg-spatialcoords">spatialCoords<a class="anchor" aria-label="anchor" href="#arg-spatialcoords"></a></dt>
<dd><p>A numeric matrix containing columns of spatial
coordinates, as in <code><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment.html" class="external-link">SpatialExperiment</a></code>. The coordinates are
centroids of the entities represented by the columns of the gene count
matrix. If <code>colGeometries</code> is also specified, then it will be given
priority and a warning is issued. Otherwise, the <code>sf</code> representation
of the centroids will be stored in the <code>colGeometry</code> called
<code>centroids</code>.</p></dd>


<dt id="arg-scalefactors">scaleFactors<a class="anchor" aria-label="anchor" href="#arg-scalefactors"></a></dt>
<dd><p>Optional scale factors associated with the image(s). This
can be provided as a numeric value, numeric vector, list, or file path to a
JSON file for the 10x Genomics Visium platform. For 10x Genomics Visium,
the correct scale factor will automatically be selected depending on the
resolution of the image from <code>imageSources</code>. Default = <code>1</code>.</p></dd>


<dt id="arg-imagesources">imageSources<a class="anchor" aria-label="anchor" href="#arg-imagesources"></a></dt>
<dd><p>Optional file path(s) or URL(s) for one or more image
sources.</p></dd>


<dt id="arg-image-id">image_id<a class="anchor" aria-label="anchor" href="#arg-image-id"></a></dt>
<dd><p>Optional character vector (same length as
<code>imageSources</code>) containing unique image identifiers.</p></dd>


<dt id="arg-loadimage">loadImage<a class="anchor" aria-label="anchor" href="#arg-loadimage"></a></dt>
<dd><p>Logical indicating whether to load image into memory.
Default = <code>FALSE</code>.</p></dd>


<dt id="arg-imgdata">imgData<a class="anchor" aria-label="anchor" href="#arg-imgdata"></a></dt>
<dd><p>Optional <code>DataFrame</code> containing the image data.
Alternatively, this can be built from the arguments <code>imageSources</code> and
<code>image_id</code> (see Details).</p></dd>


<dt id="arg-add-molecules">add_molecules<a class="anchor" aria-label="anchor" href="#arg-add-molecules"></a></dt>
<dd><p>Logical, whether to add transcripts coordinates to an
object.</p></dd>


<dt id="arg-flip">flip<a class="anchor" aria-label="anchor" href="#arg-flip"></a></dt>
<dd><p>To flip the image, geometry coordinates, or none. Because the
image has the origin at the top left while the geometry has origin at the
bottom left, one of them needs to be flipped for them to match. If one of
them is already flipped, then use "none". The image will not be flipped if
it's GeoTIFF.</p></dd>


<dt id="arg-image-scalefactors">image_scalefactors<a class="anchor" aria-label="anchor" href="#arg-image-scalefactors"></a></dt>
<dd><p># A <code>character</code>, choose between "lowres" or "hires".
Only for 10X Visium, image scaling factors are from `scalefactors_json.json` file.</p></dd>


<dt id="arg-bpparam">BPPARAM<a class="anchor" aria-label="anchor" href="#arg-bpparam"></a></dt>
<dd><p>Deprecated when coercing from <code>SpatialExperiment</code>,
but is used when coercing from <code>Seurat</code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>SpatialFeatureExperiment</code> object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: SingleCellExperiment</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: SummarizedExperiment</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: MatrixGenerics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: matrixStats</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘MatrixGenerics’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:matrixStats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colWeightedMeans, colWeightedMedians, colWeightedSds,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowWeightedSds, rowWeightedVars</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: GenomicRanges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: stats4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: BiocGenerics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘BiocGenerics’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:SpatialFeatureExperiment’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     saveRDS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     IQR, mad, sd, var, xtabs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     as.data.frame, basename, cbind, colnames, dirname, do.call,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     pmin.int, rank, rbind, rownames, sapply, saveRDS, setdiff, table,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     tapply, union, unique, unsplit, which.max, which.min</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: S4Vectors</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘S4Vectors’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:utils’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     findMatches</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     I, expand.grid, unname</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: IRanges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘IRanges’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:EBImage’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     resize, tile</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: GenomeInfoDb</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Biobase</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Welcome to Bioconductor</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Vignettes contain introductory material; view with</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     'browseVignettes()'. To cite Bioconductor, see</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘Biobase’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:MatrixGenerics’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rowMedians</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:matrixStats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     anyMissing, rowMedians</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:EBImage’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     channel</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">read10xVisium</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; dir &lt;- system.file(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   file.path("extdata", "10xVisium"), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   package = "SpatialExperiment")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; sample_ids &lt;- c("section1", "section2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; samples &lt;- file.path(dir, sample_ids, "outs")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; list.files(samples[1])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "raw_feature_bc_matrix" "spatial"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; list.files(file.path(samples[1], "spatial"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "scalefactors_json.json"    "tissue_lowres_image.png"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "tissue_positions_list.csv"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; file.path(samples[1], "raw_feature_bc_matrix")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/home/runner/work/_temp/Library/SpatialExperiment/extdata/10xVisium/section1/outs/raw_feature_bc_matrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; (spe &lt;- read10xVisium(samples, sample_ids, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   type = "sparse", data = "raw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   images = "lowres", load = FALSE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SpatialExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 50 99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(50): ENSMUSG00000051951 ENSMUSG00000089699 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ENSMUSG00000005886 ENSMUSG00000101476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(1): symbol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(99): AAACAACGAATAGTTC-1 AAACAAGTATCTCCCA-1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AAAGTCGACCCTCAGT-1 AAAGTGCCATCAATTA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(4): in_tissue array_row array_col sample_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> imgData names(4): sample_id image_id data scaleFactor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; # base directory 'outs/' from Space Ranger can also be omitted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; samples2 &lt;- file.path(dir, sample_ids)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; (spe2 &lt;- read10xVisium(samples2, sample_ids, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   type = "sparse", data = "raw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   images = "lowres", load = FALSE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: SpatialExperiment </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dim: 50 99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metadata(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assays(1): counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rownames(50): ENSMUSG00000051951 ENSMUSG00000089699 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ENSMUSG00000005886 ENSMUSG00000101476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rowData names(1): symbol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colnames(99): AAACAACGAATAGTTC-1 AAACAAGTATCTCCCA-1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AAAGTCGACCCTCAGT-1 AAAGTGCCATCAATTA-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> colData names(4): in_tissue array_row array_col sample_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reducedDimNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mainExpName: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> altExpNames(0):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spatialCoords names(2) : pxl_col_in_fullres pxl_row_in_fullres</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> imgData names(4): sample_id image_id data scaleFactor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; # tabulate number of spots mapped to tissue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; cd &lt;- colData(spe)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; table(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   in_tissue = cd$in_tissue, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV+   sample_id = cd$sample_id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          sample_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> in_tissue section1 section2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     FALSE       28       27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     TRUE        22       22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; # view available images</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rd10xV&gt; imgData(spe)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 2 rows and 4 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sample_id    image_id   data scaleFactor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   &lt;character&gt; &lt;character&gt; &lt;list&gt;   &lt;numeric&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    section1      lowres   ####   0.0510334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    section2      lowres   ####   0.0510334</span>
<span class="r-in"><span><span class="co"># There can't be duplicate barcodes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.unique.html" class="external-link">make.unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sfe</span> <span class="op">&lt;-</span> <span class="fu">toSpatialFeatureExperiment</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># For coercing Seurat to SFE see this -&gt; ./vignettes/seurat_sfe_coerce.Rmd</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lambda Moses, Alik Huseynov, Lior Pachter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

